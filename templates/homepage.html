{% extends 'base.html' %}

{% block title %}Welcome to Storenet{% endblock %}

{% block body %}

  <br>
  <div class="row">
    <div class="col-xs-12 col-md-3 col-lg-3">
      <div class="card">
        <div class="card-body">
        <h3>Store Dashboard</h3>
        Store {{ session['store_id'] }} - {{ store.name }}<br><br>
        <b>Today's Sales Projections</b><br>
        $1500<br><br>
        <b>Current Weather for {{ weather.place }}</b><br>
        <img src="{{ weather.icon }}"> {{ weather.desc }}
        <h3> Unassigned Tasks </h3> <span class="badge badge-pill badge-danger">2</span>

        </div>
      </div>
    </div>
    <div class="col-xs-12 col-md-6 col-lg-6">
      <div class="card">
          <div class="card-body">
        <!-- POSTS GO HERE -->  

          <div class="card text" class="col-xs-12 col-md-6 col-lg-6">
            <div class="card-header">
              <ul class="nav nav-tabs card-header-tabs">
                <li class="nav-item">
                  <a class="nav-link active" href="#">NEW POSTS</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="#">Last Week</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link disabled" href="#">Disabled</a>
                </li>
              </ul>
            </div>
            <div class="card-body" id='post-content'>
              <!-- begin posts -->
        {% if assigned_posts %}
          {% for assigned_post in assigned_posts %}
            {% if assigned_post.was_read == False %}
            <span class="badge badge-success">NEW</span>
            {% endif %}
            <a href='/view-post/{{ assigned_post.post_id }}'>{{ assigned_post.post.title }}</a><br>
            <small>Posted on {{ assigned_post.post.date.strftime('%a, %m.%d.%y') }}
            {% if assigned_post.post.tasks %}
            | <a href="#" class="badge badge-secondary">Action Required</a>
            {% endif %}
            </small><br><br>
          {% endfor %}
        {% else %}
            There are no new posts.
        {% endif %}
        <!-- end posts -->
              <a href="#" class="btn btn-primary">View more posts</a>
            </div>
          </div>

<table class="table table-responsive-lg">

<tr>
{% for day in calendar %}
<td>{{ day[0].day }}<br>
  {% if day[1] %}
  {% for day in day[1] %}<br>
  <small>Task due: {{ day.task_item }}</small>
  {% endfor %}
{% endif %}
</td>
{% endfor %}
</tr>
</table>

        </div>
      </div>
    </div>
    <div class="col-xs-12 col-md-3 col-lg-3">
      <div class="card">
        <div class="card-body">
        <!-- TASKS SECTION -->
        {% if incomplete_tasks %}
        <h3>Your Tasks</h3>
        <form action='/complete-task' method='post'>
          {% for task in incomplete_tasks %}
            <input type='checkbox' name='completed-tasks' value='{{task.task_id}}'>
            <a href='view-post/{{ task.post_id }}'>{{ task.task_item }}</a> due on {{ task.deadline }} which is in <b>{{ (task.deadline - current_date) }}</b>
            <br>
          {% endfor %}
            <input class="btn btn-default" type="submit" value="Mark Complete">
          </form>
        {% endif %}

        {% if complete_tasks %}
        <h3>Completed Tasks</h3>
        {% for task in complete_tasks %}
                {{ task.task_item }} completed on {{ task.complete_date }}<br>
            {% endfor %}
        {% endif %}
        <!-- END TASK SECTION -->
        </div>
      </div>
    </div>
  </div>

View post by category:
  {% for category in categories: %}
    <a href='/{{ category.cat_id }}'>{{ category.name }}</a> |
  {% endfor %}

{% endblock %}
