{% extends 'base.html' %}

{% block title %}User Profile{% endblock %}

{% block body %}

<h3>Details for {{ obj.fname }} {{ obj.lname}}</h3>


<ul>
    <li>{{ obj.fname }} {{ obj.lname }}</li>
    <li><b>Employee ID:</b> {{ obj.emp_id }}</li>
    <li><b>Position:</b>{{ obj.pos_id }} - {{ obj.position.title }}</li>
    <li><b>SSN:</b> {{ obj.ssn }}</li>
    <li>Store {{ obj.store.store_id }} {{ obj.store.name }}</li>
    <li>District {{ obj.store.district.name }}</li>
    <li>{{ obj }}</li>
</ul>

{% if obj.pos_id == "99-HQ" %}
    <p>Admin information goes here</p>
    <a href="post">Post some stuff here</a>
{% endif %}

<div id='chart'></div>

<script type="text/javascript">

function createGraph(dataset, div) {

  let width = 480;
  let height = 360;

  let scale = d3.scale.linear()
    .domain([0, 200])
    .range([0, width]);

  let colorScale = d3.scale.linear()
    .domain([0, 200])
    .range(['red', 'green']);

  let axis = d3.svg.axis()
    .ticks(5)
    .scale(scale);

  let canvas = d3.select('#chart')
    .append('svg')
    .attr('width', width)
    .attr('height', height)
    .append('g')
    .attr('transform', 'translate(20, 0)')
    
  let bars = canvas.selectAll('rect')
    .data(dataset) // This binds data to the invisible rects we created
    .enter()
      .append('rect')
      .attr('width', function(d) { return scale(d); }) // This is kind of like a loop
      .attr('height', 25)
      .attr('y', function(d, i) { return i * 40 ; })
      .attr('fill', function(d) { return colorScale(d) });

  canvas.append('g')
    .attr('transform', 'translate(0, 300)')
    .call(axis);
}

createGraph([20,40], 'chart')

$.get('/profile.json', createGraph(result.posts, 'chart'  ));



</script>



{% endblock %}